<!-- Copyright by Vitali Fedulov (www.similar.pictures) 2015-2019 --> <!DOCTYPE html> <html lang="en"> <head> <title>JPEG embedded thumbnail reader</title> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1"> <script src="js/jquery.min.js"></script> <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto"> </head> <link rel="icon" type="image/png" href="images/favicon.png"> <link rel="stylesheet" type="text/css" href="css/clustering.css"> <body> <div class="flex-container-select-files"> <div class="flex-center-horizontally"> <div> <h2 class="text-centered clustering-title">JPEG Embedded Thumbnail Reader</h2> </div> <div id="terms-of-service"> <p class="terms-of-service-header text-centered">Terms of service and data protection</p> <div id="terms"></div> </div> <div> <p id="messages" class="hidden">Messages</p> <div id="ok-button" class="text-centered"> <div class="button">OK</div> </div> <div id="file-selector" class="text-centered"> <input class="hidden" type="file" id="filesSelected" webkitdirectory multiple accept="image/*" onchange="v32(this.files)" onclick="v8()"> <a class="button">Select a folder with images</a> </div> <div class="link-block text-centered"> <a class="home-cancel-link" id="cancel-link" onclick="v31()">Cancel</a> <a class="home-cancel-link" href="/">Home</a> </div> </div> </div> </div> <div class="fixed-top hidden"> <div class="fixed-top-gray"> <a href = "index.html" class="myhref"><span class="logo">Similar<span class="logo-dot">.</span>Pictures</span></a> <div class="button button-new-search">New read</div> </div> <div class="fixed-white-1"> <div class="progress"> <div id="progress-bar"></div> </div> <div class="progress-text"></div> </div> <div class="fixed-white-2 hidden"> <span class="found-clusters"></span> <span> (</span><span class="view-list">show/hide as list</span><span>)</span> <textarea class="textarea"></textarea> <p class="explanation"> <small class="small">Scroll down to view all thumbnails.</small> </p> </div> </div> <div id="clusters" class="clusters"></div> <script> $(document).ready(function() { $("#terms").load("tos_en.html"); $("#ok-button").hide(); $("#cancel-link").hide(); $(".button-new-search").click(v34); $("#ok-button").click(v34); }); var v46 = { v28 : 80000, v5 : 50*1024*1024, v43 : 0, v40 : 0, v12 : Date.now(), v33 : 0, v26 : [], v45 : "image/jpeg", v48 : "", v25 : (function () { var v11 = new Uint32Array(10); window.crypto.getRandomValues(v11); var v23 = ""; for (var i = 0; i < v11.length; i++) { v23 += v11[i].toString(36); } return v23 }) (), v59 : null, v35 : 0, v1 : 1000, v0 : null, v22 : '\n', v13 : 0, v9 : false, v6 : 0, }; function v4() { return Math.floor((Date.now() - v46.v12) / 1000); } function v31() { v34(); } function v34() { location.reload(); $(document).ready(function(){ $(this).scrollTop(0); }); } var v24 = document.getElementById('file-selector'); v24.addEventListener('click', v19); function v19() { var v62 = document.getElementById('filesSelected'); if (!!v62.webkitdirectory == false) { alert('This browser does not support folder selection. Please try latest Chrome, Firefox or Edge.'); return; } v62.click(); } function v32(v59) { v46.v6 = 0; clearTimeout(v46.v0); $("#file-selector").hide(); v46.v59 = v59; v46.v48 = v59[0].webkitRelativePath.split("/")[0]; v46.v35 = v59.length; var v56 = 0; var v61 = 0; $(".flex-container-select-files").hide(); $(".fixed-top").show(); $(".view-list").click(v39); $(".fixed-white-2").show(); v2(); v20(v56, v61); } function v20(v56, v61) { if (v56 >= v46.v35) { v16(v56); return; } if (v56 < 5 || v56 % 5 === 0) { v3(v56); } if (!v46.v45 == v46.v59[v56].type || v46.v59[v56].size > v46.v5) { v56++; v20(v56, v61); return; } v46.v43 = v61 + 1; v27(v61, v56, function(v67) { if (v67 == null) { v56++; v61++; v20(v56, v61); return; } else { var v69 = new Image(); v69.onload = function() { v46.v13++; v46.v26[v61] = v56; v46.v40 = v56 + 1; v46.v33++; v7(v46.v33); v14(v46.v33 - 1, v61, v69); v56++; v61++; if (!v46.v9) { v46.v9 = true; } URL.revokeObjectURL(v69.src); v2(); v20(v56, v61); return; }; v69.onerror = function() { URL.revokeObjectURL(v69.src); v56++; v61++; v20(v56, v61); return; }; v69.src = URL.createObjectURL(v67); return; } }); } function v27(v61, v56, v44) { var v55 = new FileReader(); v55.readAsArrayBuffer(v46.v59[v56].slice(0, v46.v28)); v55.onload = function (v60) { var v57 = new Uint8Array(v60.target.result), v58, v68; for (var v72 = 2; v72 < v57.length; v72++) { if (v57[v72] == 0xFF) { if (!v58) { if (v57[v72 + 1] == 0xD8) { v58 = v72; } } else { if (v57[v72 + 1] == 0xD9) { v68 = v72 + 2; break; } } } } if (v58 && v68) { v44(new Blob([v57.subarray(v58, v68)], {type:v46.v45})); } else { v44(null); } }; v55.onerror = function() { v44(null); }; } function v16(v56) { if (v46.v13 == 0) { $(".fixed-top").hide(); $(".flex-container-select-files").show(); $("#messages").text("No images with embedded thumbnails found. Please select a different folder."); $("#messages").show(); $("#file-selector").hide(); $("#cancel-link").hide(); $("#ok-button").show(); return; } $(".progress")[0].remove(); var v71 = "s"; if (v56 + 1 == 1) { v71 = ""; } v10(".progress-text", "Successfully scanned ".concat(v46.v59.length, " file", v71, ".")); if (v46.v33 == 0) { v10(".progress-text", "Zero thumbnails found from the successfully scanned ".concat(v46.v59.length, " file", v71, ".")); } return; } function v10(v17, v65) { $(v17)[0].textContent = v65; } function v2() { var v71 = "s"; if (v46.v33 == 1) { v71 = ""; } v10(".found-clusters", "Found ".concat(v46.v33, ' embedded thumbnail', v71)); } function v3(v56) { if (v56 + 1 == v46.v35) { return; } v10(".progress-text", "Please wait... Reading ".concat(v56, ' from ', v46.v35, ' selected files.')); var v51 = Math.floor(100 * (v56 + 1) / v46.v35); if (v51 < 5) { v51 = 5; } var v47 = "".concat(v51, "%"); $("#progress-bar").width(v47); } function v49(v30, v21) { var v64 = document.createElement("div"); v64.className = v30; v21.appendChild(v64); return v64; } var v29 = document.getElementById("clusters"); function v7(v42) { var v37 = v49("cluster", v29); var v41 = v49("cluster-num", v37); v41.textContent = v42; var v18 = v49("cluster-content", v37); v49("cluster-imgs", v18); v49("cluster-paths", v18); } function v14(v42, v61, v69) { var v50 = $( ".cluster-imgs" )[v42]; var v54 = v49("cluster-img-div", v50); v69.classList.add("cluster-img"); v54.appendChild(v69); var v36 = v49("image-size", v54); v36.textContent = "".concat(v69.width, "Ã—", v69.height); var v15 = $( ".cluster-paths" )[v42]; var v38 = v49("img-path", v15); var v63 = v46.v59[v46.v26[v61]]; v38.textContent = v63.webkitRelativePath; v46.v6++; } function v39() { var v66 = ""; var v52 = $(".img-path"); for (v70 = 0; v70 < v52.length; v70++) { var v53 = v52[v70].textContent; v66 = v66.concat(v53, v46.v22); } v66 = v66.slice(0, -1); $(".textarea").val(v66); $(".textarea").toggleClass("textareaon"); } function v8() { $("#terms-of-service").hide(); $(".text-left").hide(); $(".vertical-center-row").toggleClass("vertical-center-narrow"); v46.v0 = setTimeout(function() { $("#messages").text('Please wait if you selected a very large number of images: it may take tens of seconds before the reading starts.'); $("#messages").show(); $("#file-selector").hide(); $("#fast").hide(); $("#cancel-link").show(); }, v46.v1); } </script> </body> </html>